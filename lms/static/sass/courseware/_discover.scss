/* =========================
   DISCOVER COURSES – MERGED
   ========================= */

/* ===== Layout khung trang ===== */
.window-wrap #content.content-wrapper {
  padding: 0 !important;
  margin: 0 !important;
  max-width: 100%;

  @include media-breakpoint-up(lg) {
    margin-top: 64px !important;
  }
}
#main {
  margin: 0;
  @include media-breakpoint-up(md) {
    margin: 0 150px;
  }
}

/* ===== Heading intro ===== */
.course-heading-area {
  margin: 0 0 20px;
  font-size: 14px;
  color: #515661;

  @include media-breakpoint-up(md) {
    margin: 0 0 30px;
    font-size: 16px;
    line-height: 20px;
  }

  h2 {
    color: #111827;
    font-size: 20px;
    font-weight: 700;
    line-height: 30px;
    margin: 0 0 8px;

    @include media-breakpoint-up(md) {
      font-size: 24px;
      font-weight: 700;
      margin: 0 0 12px;
    }
  }

  p { margin: 0; }
}

/* ===== Khối find-courses + container ===== */
.find-courses {
  padding-bottom: 0 !important;

  .courses-container {
    padding: 25px 0;

    @include media-breakpoint-up(md) { padding: 60px 0; }
    @include media-breakpoint-down(md) { padding: 90px 0; }
  }

  .course-holder {
    width: 100% !important;
    float: none !important;
  }
}

/* ===== Nút Learn more & date về vị trí tự nhiên ===== */
.courses-container .courses .courses-listing li .course .course-info .learn-more,
.courses-container .courses .courses-listing li .course .course-info .course-date {
  position: static !important;
  float: none !important;
  clear: none !important;
}

/* ===== Style nút Learn more (phiên bản sáng) ===== */
.courses-container .courses .courses-listing li .course .course-info a.learn-more,
.courses-container .courses .courses-listing li .course .course-info .learn-more {
  display: block !important;
  width: 90% !important;
  margin: 10px auto 0 !important;
  box-sizing: border-box !important;
  background: $primary !important;
  color: #fff !important;
  text-align: center !important;
  text-decoration: none !important;
  font-weight: 500 !important;
  font-size: 16px !important;
  line-height: 22px !important;
  padding: 10px 8px !important;
  border: 1px solid transparent !important;
  box-shadow: none !important;
  border-radius: 8px !important;
}

/* ===== Thông tin card ===== */
.courses-container .courses .courses-listing li .course .course-info {
  font-size: 15px !important;
  line-height: 22px !important;
  padding: 0 20px;
}

/* ===== Tiêu đề khóa học (clamp 2 dòng) ===== */
.courses-container .courses .courses-listing li .course .course-info .course-title,
.courses-container .courses .courses-listing li .course .course-info .course-title a {
  color: black !important;
  text-decoration: none !important;
  font-weight: 500 !important;
}
.courses-container .courses .courses-listing li .course .course-info .course-title a:hover,
.courses-container .courses .courses-listing li .course .course-info .course-title a:focus,
.courses-container .courses .courses-listing li .course .course-info .course-title a:active,
.courses-container .courses .courses-listing li .course .course-info .course-title a:visited {
  color: black !important;
  text-decoration: none !important;
  font-weight: 500 !important;
}
.courses-container .courses .course .course-info .course-title {
  font-size: 0.95rem !important;
  font-weight: 600 !important;
  color: #111827 !important;
  line-height: 1.35 !important;
  margin: 4px 0 8px !important;

  display: -webkit-box !important;
  -webkit-box-orient: vertical !important;
  -webkit-line-clamp: 2 !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  white-space: normal !important;
  word-wrap: break-word !important;
  overflow-wrap: anywhere !important;

  height: calc(1.35em * 2) !important;
  max-height: calc(1.35em * 2) !important;
}

/* ===== Card bo góc + hover ===== */
.courses-container .courses .courses-listing li .course,
.courses-host .course {
  border-radius: 12px !important;
  overflow: hidden !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08) !important;
  transition: transform 0.25s ease, box-shadow 0.25s ease !important;
}
.courses-container .courses .courses-listing li .course:hover,
.courses-host .course:hover {
  transform: translateY(-4px) !important;
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12) !important;
}

/* ===== Dòng ngày bắt đầu ===== */
.course-date {
  display: inline-flex !important;
  align-items: center !important;
  gap: 6px !important;
  line-height: 1.4 !important;
  vertical-align: middle !important;
  width: 90% !important;
  margin: 3px auto 12px !important;
  padding: 0 20px !important;
}
@media (max-width: 576px) {
  .course-date { width: 95% !important; }
}
.course-date svg {
  flex-shrink: 0 !important;
  width: 18px !important;
  height: 18px !important;
  margin: 0 !important;
  position: relative !important;
  top: 0 !important;
}

/* =========================
   Search bar + Filters (UI)
   ========================= */
.saerch-bar-discover {
  margin: 0 0 25px;
  display: flex;
  gap: 12px;

  @include media-breakpoint-up(lg) { flex-direction: row; }
  @include media-breakpoint-down(lg) { flex-direction: column; }
  @include media-breakpoint-up(md) { margin: 0 0 30px; }

  &:after { display: block; clear: both; content: ""; }

  .filters {
    .filters-inner {
      border: none;
      .clear-filters { display: none; }
      ul {
        li {
          padding: 0;
          margin: 0 7px 5px 0;
          background: none;
          button {
            padding: 2px 10px;
            border-radius: 12px;
            background: $primary !important;
            color: #fff;
            font-size: 14px;
            line-height: 20px;
            margin-bottom: 4px !important;
          }
        }
      }
    }
  }

  /* Toggle filters button */
  .filter-block {
    > a {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background-color: #f3f4f6;
      color: #374151;
      font-weight: 600;
      font-size: 14px;
      border-radius: 8px;
      padding: 8px 14px;
      transition: background 0.2s ease;
      border: 1px solid #e5e7eb;

      &:hover { background-color: #e5e7eb; }
      svg { stroke: #9ca3af; width: 18px; height: 18px; }
      .arrow { fill: #9ca3af; }
    }
  }

  /* Ô tìm kiếm */
  .discover-search {
    width: 100%;

    .wrapper-search-context {
      .wrapper-search-input {
        float: none;
        display: flex;
        margin: 0;
        width: auto;

        align-items: center;
        border: 1px solid #e5e7eb;
        border-radius: 9999px;
        overflow: hidden;
        background: #fff;
        height: 46px;
        padding: 0;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        transition: box-shadow 0.2s ease;

        &:after { display: block; clear: both; content: ""; }
        &:focus-within {
          border-color: #10b981;
          box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.25);
        }

        .button-holder {
          flex-shrink: 0;
          margin: 0 !important;

          background-color: #F2F7F8;

          button {
            position: static;
            min-width: 100px;
            height: 46px;
            padding: 0 26px;
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
            border-top-right-radius: 10px;
            border-bottom-right-radius: 10px;
            border: none;
            box-shadow: none !important;

            color: #fff;
            font-size: 15px;
            font-weight: 600;
            line-height: 46px;
            text-align: center;
            font-family: "Inter", "Segoe UI", sans-serif;
            background: linear-gradient(135deg, #10b981, #0056a1);
            transition: all 0.2s ease;

            &:active { transform: translateY(0); }
          }
        }

        .input-holder {
          flex-grow: 1;
          position: relative;
          border-radius: 6px 0 0 6px;
          background: $primary-light;
          padding: 0 0 0 33px;

          svg {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            width: 18px; height: 18px;
            path { fill: #9ca3af; }
          }

          input {
            border: none;
            box-shadow: none;
            height: 46px;
            width: 100%;
            background: transparent;
            outline: none;
            font-size: 15px;
            padding: 0 12px 0 42px;
            color: #111827;
            font-family: "Inter", "Segoe UI", sans-serif;

            &::placeholder { color: #9ca3af; font-weight: 400; }
          }
        }
      }

      .search-status-label {
        font-size: 14px;
        line-height: 20px;
        padding: 10px 0 0;
        color: #6b7280;
        text-align: center;
        height: auto;
        min-height: auto;
        width: 100%;
        float: none;
      }
    }
  }
}

/* ===== Dropdown facets ===== */
.filter-block {
  position: relative;
  z-index: 9;

  .dropdown-toggle {
    height: 30px;
    @include media-breakpoint-up(sm) { min-width: 100px; }
  }

  &.show { .dropdown-menu { display: block; } }

  .dropdown-menu {
    display: none;
    width: 200px;
    left: 0;
    top: 53px !important;
    transform: none !important;
    border-radius: 6px;
    background: $primary-light;
    padding: 10px 10px 0;
    box-shadow:
      0px 0px 0px 1px rgba(0, 0, 0, 0.05),
      0px 4px 6px -2px rgba(0, 0, 0, 0.05),
      0px 10px 15px -3px rgba(0, 0, 0, 0.1);
  }

  .search-facets {
    float: none;
    width: 100% !important;
    margin: 0;
    box-shadow: none;
    background: none;

    h2 { display: none; }

    .search-facets-lists {
      h3 {
        border: none;
        padding: 0;
        margin: 0 0 10px;
        color: #191b23;
        font-size: 14px;
        font-weight: 700;
      }

      ul.facet-list {
        padding: 0 0 0 25px;
        max-height: 100px;
        overflow-y: auto;

        li {
          height: auto;
          margin: 0 0 10px;

          button.facet-option {
            position: relative;
            float: none;
            width: auto;
            background: none !important;
            padding: 0 0 0 24px;
            font-size: 14px;
            line-height: 20px;
            color: #191b23;

            &.selected {
              .count {
                background: $primary;
                border-color: $primary;

                &:before {
                  content: "\f00c";
                  width: auto;
                  top: 0; left: 2px;
                  display: block;
                  font-size: 10px;
                  line-height: 14px;
                  color: #fff;
                }
              }
            }

            .count {
              position: absolute;
              left: 0; right: auto; top: 2px;
              width: 16px; height: 16px;
              border-radius: 4px;
              border: 1px solid #c4c7cf;
              background: #fff;

              .count-number { display: none; }
            }
          }
        }
      }
    }
  }
}

/* =========================
   Dark theme (Indigo)
   ========================= */
body.indigo-dark-theme {
  .course-heading-area {
    color: $text-color-primary;
    h2 { color: $text-color-d; }
  }

  .saerch-bar-discover {
    .filters .filters-inner ul li button {
      background: $primary-d !important;
      color: $btn-color-d;
    }

    .discover-search {
      .wrapper-search-input {
        background: #1e293b;
        border-color: #334155;

        .button-holder button {
          background: linear-gradient(135deg, #10b981, #0284c7);
          color: #fff;
        }

        .input-holder {
          background: $primary-light-d;

          svg path { color: $text-color-d; }
          input { color: $text-color-d; }
        }
      }

      .search-status-label { color: $text-color-primary; }
    }

    .filter-block > a {
      background-color: $primary-light-d;
      color: $text-color-d;
      border: 1px solid #334155;

      &:hover { color: $text-color-d; background: #334155; }
      svg { fill: transparent; stroke: $text-color-d; }
      .arrow { fill: $text-color-d; stroke: none; }
    }

    .filter-block .dropdown-menu { background: $primary-light-d; }
    .filter-block .search-facets .search-facets-lists h3 { color: $text-color-d; }
    .filter-block .search-facets .search-facets-lists ul.facet-list li button.facet-option {
      color: $text-color-d;
      &.selected .count {
        background: $primary-d; border-color: $primary-d;
        &:before { color: $btn-color-d; }
      }
      .count { border: 1px solid $text-color-d; background: $text-color-d; }
    }
  }

  .courses-container .courses .courses-listing li .course {
    box-shadow: none;
    border: 1px solid $border-color-d;
    background: $primary-light-d;

    .course-info {
      .course-title { color: $text-color-d; }
      .course-organization { color: $text-color-primary; }
      .learn-more { background: $primary-d; color: $btn-color-d; }
      .course-date {
        border-top: 1px solid $border-color-d;
        color: $text-color-primary;
        background: $light-overlay-d;
        svg path { fill: $text-color-primary; }
      }
    }
  }
}

/* =========================
   Ảnh cover course
   ========================= */
.courses-container .courses .courses-listing li .course .course-image {
  position: relative !important;
  width: 100% !important;
  overflow: hidden !important;
  background: #000 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}
.courses-container .courses .courses-listing li .course .course-image img {
  width: 100% !important;
  height: auto !important;
  max-height: 240px !important;
  object-fit: cover !important;
  object-position: center center !important;
  display: block !important;
  margin: 0 auto !important;
  background-color: #000 !important;
  transition: none !important;
}
.courses-container .courses .courses-listing li .course:hover .course-image img {
  transform: none !important;
  filter: none !important;
  opacity: 1 !important;
}

/* =========================
   FIX RESPONSIVE CHỒNG CARD
   (DÙNG FLEX – KHÔNG DÙNG GRID)
   ========================= */
$course-gap: 20px;

.courses-container .courses .courses-listing {
  display: flex !important;
  flex-wrap: wrap !important;
  gap: $course-gap !important;

  width: 100% !important;
  margin: 0 auto !important;
  padding: 0 16px 64px !important;
  list-style: none !important;
  box-sizing: border-box !important;
  clear: both !important;

  /* Đảm bảo mọi rule grid cũ không còn tác dụng */
  grid-template-columns: unset !important;
}

/* Mặc định (mobile): 1 cột */
.courses-container .courses .courses-listing > li {
  float: none !important;
  margin: 0 !important;
  list-style: none !important;
  box-sizing: border-box !important;
  vertical-align: top !important;

  flex: 0 0 100% !important;
  max-width: 100% !important;
  width: auto !important;
}

/* ≥ md: 2 cột */
@include media-breakpoint-up(md) {
  .courses-container .courses .courses-listing > li {
    flex: 0 0 calc(50% - #{$course-gap} / 2) !important;
    max-width: calc(50% - #{$course-gap} / 2) !important;
  }
}

/* ≥ xl: 3 cột */
@include media-breakpoint-up(xl) {
  .courses-container .courses .courses-listing > li {
    flex: 0 0 calc(33.333% - (#{$course-gap} * 2 / 3)) !important;
    max-width: calc(33.333% - (#{$course-gap} * 2 / 3)) !important;
  }
}

/* Card bên trong fill full chiều ngang item */
.courses-container .courses .courses-listing > li .course {
  width: 100% !important;
  height: 100% !important;
  display: flex !important;
  flex-direction: column !important;
}

/* Một số tinh chỉnh nhỏ trên card */
.courses-container .courses .courses-listing li .course .course-info .course-code {
  background: none !important;
  color: #6b7280 !important;
  font-weight: 600 !important;
  font-size: 13px !important;
  margin-bottom: 2px !important;
  display: block !important;
}
.courses-container .courses .courses-listing li .course .course-info .course-organization {
  margin-bottom: 6px !important;
}
.courses-container .courses .courses-listing li .course .course-info .learn-more {
  margin-top: 6px !important;
  font-size: 13.5px !important;
  font-weight: 600 !important;
  width: 75% !important;
  border-radius: 8px !important;
  background: #0b3472 !important;
}
.courses-container .courses .courses-listing li .course .course-info .course-date {
  font-size: 13px !important;
  color: #6b7280 !important;
  opacity: 0.9 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: flex-start !important;
  padding-left: 20px !important;
  margin-top: 8px !important;
}
.courses-container .courses .courses-listing li .course .course-info .course-date svg {
  width: 15px !important;
  height: 15px !important;
  flex-shrink: 0 !important;
  margin-right: 4px !important;
}

/* Mobile spacing */
@media (max-width: 576px) {
  .courses-container .courses .courses-listing li .course .course-info {
    padding: 14px 18px !important;
  }
}

/* ===== Footer luôn dưới ===== */
footer,
.site-footer {
  position: relative !important;
  z-index: 2 !important;
}

/* =========================
   Layout 2 cột: Sidebar facet
   ========================= */
@include media-breakpoint-up(xl) {
  .courses-container {
    display: grid;
    grid-template-columns: 280px 1fr;
    grid-column-gap: 24px;
    align-items: start;
  }

  .hide-large { display: none !important; }

  .filters-sidebar {
    display: block;
    position: sticky;
    top: 96px;
    max-height: calc(100vh - 120px);
    overflow: auto;
    padding: 12px;
    border-right: 1px solid #e5e7eb;
  }

  .filters-sidebar .search-facets {
    box-shadow: none !important;
    background: transparent !important;
    margin: 0 !important;
  }

  .filters-sidebar .search-facets .search-facets-lists h3 {
    margin: 0 0 10px;
    font-size: 14px;
    font-weight: 700;
    color: #191b23;
  }

  .filters-sidebar .search-facets .search-facets-lists ul.facet-list {
    padding-left: 25px;
    max-height: none;
    overflow: visible;
  }

  .saerch-bar-discover { grid-column: 2 / -1; }
  .course-holder { grid-column: 2 / -1; }
}

/* Dark mode cho sidebar */
body.indigo-dark-theme {
  @include media-breakpoint-up(xl) {
    .filters-sidebar {
      background: $primary-light-d;
      border: 1px solid $border-color-d;
    }
    .filters-sidebar .search-facets .search-facets-lists h3 { color: $text-color-d; }
    .filters-sidebar .search-facets .search-facets-lists ul.facet-list li button.facet-option {
      color: $text-color-d;
    }
  }
}

/* Toggle filter ở mobile */
.filter-block > a { display: inline-flex; }
.filter-block .dropdown-menu { display: none; }
.filter-block.show .dropdown-menu { display: block; }

/* Khi facets đã chuyển sang sidebar thì ẩn toggle */
body.facet-sidebar-active .filter-block > a { display: none; }
body.facet-sidebar-active .filter-block .dropdown-menu { display: none; }
