<%page expression_filter="h"/>
<%inherit file="main.html"/>
<%namespace name="static" file="static_content.html"/>

<%!
from django.utils.translation import gettext as _
from django.urls import reverse, NoReverseMatch
from openedx.core.djangolib.markup import HTML, Text
%>

<!-- ====== Styles cho ph·∫ßn BODY (hero + search + sections) ====== -->
<style>
:root{
  --brand:#0056A1; --accent:#10B981;
  --bg:#ffffff; --ink:#111827; --muted:#6b7280;
  --card:#ffffff; --line:#e5e7eb;
}
#theme:checked~.page{
  --bg:#0f172a; --ink:#e5e7eb; --muted:#9aa3b2; --card:#0b1220; --line:#243355;
}

/* layout helpers */
.container{max-width:1200px;margin:0 auto;padding:0 1.25rem}
.section-gap{padding:2.5rem 0}

/* ===== HERO ===== */
.hero{
  background:
    radial-gradient(900px 420px at 80% -10%, rgba(16,185,129,.18), transparent 60%),
    radial-gradient(900px 420px at -10% 20%, rgba(0,86,161,.20), transparent 60%),
    linear-gradient(135deg, #0c62ad, #12b07f);
  color:#fff;
}
.hero-title{font-size:2.25rem;font-weight:800;line-height:1.2;color:#fff}
.hero .inner{padding:3.2rem 0 2rem;text-align:center}
.hero .badge{
  display:inline-flex;align-items:center;gap:.5rem;
  padding:.4rem .75rem;border-radius:999px;
  background:rgba(255,255,255,.16);border:1px solid rgba(255,255,255,.35);
  font-weight:700
}
.hero h1{font-size:clamp(1.8rem,2.6vw,2.6rem);margin:.9rem 0 .3rem}
.hero p.lead{max-width:820px;margin:0 auto;color:rgba(255,255,255,.95)}

/* Search bar */
.hero .search-wrap{max-width:980px;margin:1.25rem auto 0}
.searchbar{
  display:flex;gap:.6rem;align-items:center;
  background:rgba(255,255,255,.18);backdrop-filter:blur(6px);
  border:1px solid rgba(255,255,255,.55);padding:.5rem;border-radius:16px;
}
.searchbar .icon{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;background:#fff;color:#374151;border:1px solid var(--line);flex:0 0 auto}
.searchbar .input{flex:1 1 auto;min-width:200px;display:flex;align-items:center;background:#fff;border:1px solid var(--line);border-radius:12px;padding:.15rem .4rem}
.searchbar input[type="search"]{width:100%;border:0;outline:none;background:transparent;padding:.7rem .6rem;font-size:1rem;color:#111827}
.searchbar select{flex:0 0 170px;background:#fff;color:#111827;border:1px solid var(--line);border-radius:12px;padding:.7rem .9rem}
.searchbar button{flex:0 0 auto;background:#0a4b8a;border:1px solid #0a4b8a;color:#fff;border-radius:12px;padding:.85rem 1.1rem;font-weight:800;cursor:pointer}
.searchbar button:focus-visible{outline:3px solid rgba(255,255,255,.6);outline-offset:2px}

/* hero CTAs */
.hero .ctas{display:flex;gap:.7rem;justify-content:center;margin-top:1rem;flex-wrap:wrap}
.btn{display:inline-flex;align-items:center;gap:.55rem;padding:.75rem 1rem;border-radius:12px;font-weight:800;border:1px solid rgba(255,255,255,.6);background:rgba(255,255,255,.12);color:#fff;text-decoration:none}
.btn.primary{background:#fff;color:#0f172a;border-color:#fff}
.btn:hover{filter:brightness(.97)}

/* ===== SECTION TITLE ===== */
.section-title{display:flex;align-items:center;gap:.6rem}
.section-title h2{margin:0;color:var(--ink);font-size:1.35rem}
.section-title .emoji{font-size:1.15rem}

/* wrapper g·ªëc c·ªßa danh s√°ch */
.courses-host{margin-top:.75rem}
.courses-host .courses-container{background:transparent}

/* Responsive nh·ªè */
@media (max-width: 768px){
  .searchbar{flex-wrap:wrap}
  .searchbar .icon{display:none}
  .searchbar select{flex:1 1 45%}
  .searchbar button{flex:1 1 45%}
}

/* =========================
   COURSES LIST ‚Äì FLEX WRAP
   √Åp d·ª•ng cho c·∫£ homepage & discover
   ========================= */

/* UL (container) */
.courses-listing{
  width:100%;
  display:flex;
  flex-wrap:wrap;
  gap:20px;
  list-style:none;
  padding:0;
  margin:1rem 0 0;
  box-sizing:border-box;
}

/* LI (item) ‚Äì m·∫∑c ƒë·ªãnh 1 c·ªôt */
.courses-listing > li,
.courses-listing-item{
  float:none !important;
  margin:0;
  padding:0;
  box-sizing:border-box;
  flex:0 0 100%;
  max-width:100%;
  width:auto;
  vertical-align:top;
}

/* ‚â•768px: 2 c·ªôt */
@media (min-width:768px){
  .courses-listing > li,
  .courses-listing-item{
    flex:0 0 calc(50% - 10px);
    max-width:calc(50% - 10px);
  }
}

/* ‚â•1200px: 3 c·ªôt */
@media (min-width:1200px){
  .courses-listing > li,
  .courses-listing-item{
    flex:0 0 calc(33.333% - 13.333px);
    max-width:calc(33.333% - 13.333px);
  }
}

/* Card fill full chi·ªÅu ngang item */
.courses-listing > li .course,
.courses-listing-item .course{
  display:flex;
  flex-direction:column;
  width:100%;
  height:100%;
  border-radius:12px;
  overflow:hidden;
  box-shadow:0 4px 12px rgba(0,0,0,.08);
  transition:transform .25s ease, box-shadow .25s ease;
}
.courses-listing > li .course:hover,
.courses-listing-item .course:hover{
  transform:translateY(-4px);
  box-shadow:0 6px 20px rgba(0,0,0,.12);
}

/* ·∫¢nh cover g·ªçn g√†ng, kh√¥ng gi√£n */
.courses-listing .course .course-image{
  position:relative;
  width:100%;
  overflow:hidden;
  background:#000;
  display:flex;align-items:center;justify-content:center;
  background-color: white !important;
  border:none !important;
}
.courses-listing .course .course-image img{
  width:100%;
  height:160px;
  max-height:240px;
  object-fit:cover;
  object-position:center;
  display:block;
  margin:0;
  margin-bottom:5px;
}

/* N·ªôi dung + title clamp 2 d√≤ng */
.courses-listing .course .course-info{padding:0 20px}
.courses-listing .course .course-info .course-title{
  font-size:1rem;font-weight:600;color:#111827;line-height:1.35;margin:4px 0 8px;
  display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;
  overflow:hidden;text-overflow:ellipsis;height:calc(1.35em * 2);max-height:calc(1.35em * 2);
}
.courses-listing .course .course-info .course-code{
  background:none;color:#6b7280;font-weight:600;font-size:13px;margin-bottom:2px;display:block;
}
.courses-listing .course .course-info .course-organization{margin-bottom:6px}

/* N√∫t Learn more */
.courses-listing .course .course-info .learn-more{
  display:block;background:#0b3472;color:#fff;
  text-align:center;font-weight:600;font-size:13.5px;line-height:22px;padding:10px 8px;border-radius:8px;
  margin: 0 !important;
}

/* Ng√†y b·∫Øt ƒë·∫ßu */
.courses-listing .course .course-info .course-date{
  display:flex;align-items:center;gap:6px;font-size:13px;color:#6b7280;opacity:.9;
  justify-content:flex-start;margin:8px 0 12px;
  padding: 0 !important;
}
.courses-listing .course .course-info .course-date svg{
  width:15px;height:15px;flex-shrink:0;margin-right:4px;
}

.course-meta {
  padding: 8px 0 8px;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  flex-direction: row;
}

.course-meta span {
  border: 1px solid var(--line);
  border-radius: 8px;
  padding: 4px 8px;
  font-size: 12px;
}

.learn-more {
  background: radial-gradient(900px 420px at 80% -10%, rgba(16,185,129,.18), transparent 60%),
    radial-gradient(900px 420px at -10% 20%, rgba(0,86,161,.20), transparent 60%),
    linear-gradient(135deg, #0c62ad, #12b07f) !important;
}

.course-org {
  background: radial-gradient(900px 420px at 80% -10%, rgba(16,185,129,.18), transparent 60%),
    radial-gradient(900px 420px at -10% 20%, rgba(0,86,161,.20), transparent 60%),
    linear-gradient(135deg, #0c62ad, #12b07f) !important;
  
  color: white;
  font-weight: bold;
  font-size: 16px !important;
}

/* Mobile padding trong card */
@media (max-width:576px){
  .courses-listing .course .course-info{padding:14px 18px}
}

/* === Tinh ch·ªânh ri√™ng d·∫£i 770‚Äì1000px === */
@media (min-width: 770px) and (max-width: 999.98px) {
  /* gi·∫£m gap ƒë·ªÉ kh√¥ng ‚Äúc·∫•n‚Äù ·ªü tablet */
  .courses-listing { gap: 16px !important; }

  /* v·∫´n 2 c·ªôt nh∆∞ng tr·ª´ ƒë√∫ng n·ª≠a gap m·ªõi */
  .courses-listing > li,
  .courses-listing-item {
    flex: 0 0 calc(50% - 8px) !important;
    max-width: calc(50% - 8px) !important;
  }

  /* g·ªçn padding & ·∫£nh th·∫•p h∆°n ch√∫t cho c√¢n ƒë·ªëi */
  .courses-listing .course .course-info { padding: 0 16px !important; }
  .courses-listing .course .course-image img { max-height: 220px !important; }
}

/* (tu·ª≥ ch·ªçn) c·ªë ƒë·ªãnh 2 c·ªôt cho d·∫£i 992‚Äì1199px ƒë·ªÉ kh√¥ng ‚Äúnh·∫£y‚Äù 3 c·ªôt qu√° s·ªõm */
@media (min-width: 992px) and (max-width: 1060px) {
  .courses-listing > li,
  .courses-listing-item {
    flex: 0 0 calc(50% - 10px) !important;
    max-width: calc(50% - 10px) !important;
  }
}

@media (min-width: 770px) and (max-width: 1060px) {
  .courses-listing { justify-content: center !important; }
  #main {
    margin: 0 !important;
  }
}

@media (min-width: 1060px) {
  #main {
    margin: 0 !important;
  }
}
</style>

<div class="page">

  <!-- HERO SECTION -->
  <section class="hero">
    <div class="container inner">
      <div class="badge">${_('D√†nh cho h·ªçc vi√™n v√† gi·∫£ng vi√™n')}</div>

      <div class="heading-group" style="margin-top:.6rem">
        % if homepage_overlay_html:
          ${homepage_overlay_html | n, decode.utf8}
        % else:
          <h1 class="hero-title">${_('Kh√°m ph√° c√°c kh√≥a h·ªçc')}</h1>
          <p class="lead">
            ${_('H·ªçc l·∫≠p tr√¨nh, d·ªØ li·ªáu, thi·∫øt k·∫ø v√† nhi·ªÅu lƒ©nh v·ª±c kh√°c v·ªõi l·ªô tr√¨nh r√µ r√†ng v√† n·ªôi dung ch·∫•t l∆∞·ª£ng cao.')}
          </p>
        % endif
      </div>

      % if settings.FEATURES.get('ENABLE_COURSE_DISCOVERY'):
      <form class="search-wrap" role="search" aria-label="${_('T√¨m ki·∫øm kh√≥a h·ªçc')}" method="get" action="/courses">
        <div class="searchbar" role="group">
          <div class="icon" aria-hidden="true">üîé</div>
          <div class="input">
            <svg aria-hidden="true" width="22" height="22" viewBox="0 0 20 20" style="margin-left:.4rem">
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M8 4C5.79 4 4 5.79 4 8s1.79 4 4 4 4-1.79 4-4S10.21 4 8 4Zm-6 4a6 6 0 1 1 10.89 3.48l4.82 4.82a1 1 0 0 1-1.42 1.42l-4.82-4.82A6 6 0 0 1 2 8Z"
                fill="#9CA3AF"/>
            </svg>
            <input name="search_query" type="search" placeholder="${_('T√¨m ki·∫øm kh√≥a h·ªçc...')}" aria-label="${_('Search for a course')}"/>
          </div>
          <select aria-label="${_('B·ªô l·ªçc')}">
            <option value="all">${_('T·∫•t c·∫£')}</option>
            <option value="courses">${_('Kh√≥a h·ªçc')}</option>
          </select>
          <button type="submit">${_('T√¨m ki·∫øm')}</button>
        </div>
      </form>
      % endif

      <div class="ctas">
        <a class="btn btn-primary" href="/courses">${_('B·∫Øt ƒë·∫ßu h·ªçc')}</a>
        <a class="btn" href="/dashboard">${_('B·∫£ng ƒëi·ªÅu khi·ªÉn c·ªßa t√¥i')}</a>
      </div>
    </div>
  </section>

  <main id="main" aria-label="${_('N·ªôi dung')}" tabindex="-1">
    % if show_homepage_promo_video:
      <section class="section-gap">
        <div class="container">
          <%include file="index_promo_video.html" />
        </div>
      </section>
    % endif

    <!-- COURSES LIST -->
    <section class="section-gap">
      <div class="container">
        <div class="section-title">
          <span class="emoji">üìö</span>
          <h2>${_('Kh√≥a h·ªçc n·ªïi b·∫≠t')}</h2>
        </div>

        <div class="courses-host">
          <div class="courses-container_">
            <%include file="${courses_list}" />
          </div>
        </div>
      </div>
    </section>

  </main>

  % if include_dependencies:
    <%static:js group='base_vendor'/>
    <%static:css group='style-vendor'/>
    <%include file="widgets/segment-io.html" />
    <%include file="widgets/segment-io-footer.html" />
  % endif

    % if footer_css_urls:
    % for url in footer_css_urls:
      <link rel="stylesheet" type="text/css" href="${url}"/>
    % endfor
  % endif

</div>